<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Worksheet 1, Part 1c</title>
  <style>
    canvas {
      width: 512px;
      height: 512px;
      border: 1px solid #333;
      display: block;
      margin: 1rem auto;
    }
  </style>
</head>

<body>
  <a href="../" style="display:inline-block;margin:1rem;color:#666;text-decoration:none;">← Back to Worksheet 1</a>
  <h1 style="text-align:center;">Worksheet 1 · Part 1c</h1>
  <canvas id="gfx" width="512" height="512"></canvas>

  <script defer src="../../common/MV.js"></script>

  <script id="shader-rays" type="x-shader/wgsl">
    struct VSOut {
      @builtin(position) pos : vec4<f32>,
      @location(0) img : vec2<f32>,   // image-plane coords ∈ [-1,1]^2
    };

    @vertex
    fn vsMain(@builtin(vertex_index) vid : u32) -> VSOut {
      var corners = array<vec2<f32>, 4>(
        vec2<f32>(-1.0, -1.0),
        vec2<f32>( 1.0, -1.0),
        vec2<f32>(-1.0,  1.0),
        vec2<f32>( 1.0,  1.0)
      );
      var out : VSOut;
      let p = corners[vid];
      out.pos = vec4<f32>(p, 0.0, 1.0);
      out.img = p;   // pass to fragment
      return out;
    }

    struct Ray { origin: vec3<f32>, dir: vec3<f32> };

    @fragment
    fn fsMain(@location(0) img : vec2<f32>) -> @location(0) vec4<f32> {
      let eye = vec3<f32>(0.0, 0.0, 0.0);
      let d   = 1.0;
      let P   = vec3<f32>(img.x, img.y, d);
      let dir = normalize(P - eye);
      let ray = Ray(eye, dir);

      let rgb = ray.dir * 0.5 + vec3<f32>(0.5, 0.5, 0.5);
      return vec4<f32>(rgb, 1.0);
    }
  </script>


  <script type="module" src="main.js"></script>
</body>

</html>